
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.2">
<meta name="author" content="Rob Winch">
<title>Spring Session</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400">
<style>article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}audio,canvas,video{display:inline-block}audio:not([controls]){display:none;height:0}[hidden],template{display:none}script{display:none!important}html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}a{background:transparent}a:focus{outline:thin dotted}a:active,a:hover{outline:0}h1{font-size:2em;margin:.67em 0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:bold}dfn{font-style:italic}hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}mark{background:#ff0;color:#000}code,kbd,pre,samp{font-family:monospace;font-size:1em}pre{white-space:pre-wrap}q{quotes:"\201C" "\201D" "\2018" "\2019"}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:0}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{border:0;padding:0}button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}button,input{line-height:normal}button,select{text-transform:none}button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}textarea{overflow:auto;vertical-align:top}table{border-collapse:collapse;border-spacing:0}*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}html,body{font-size:100%}body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}a:hover{cursor:pointer}img,object,embed{max-width:100%;height:auto}object,embed{height:100%}img{-ms-interpolation-mode:bicubic}#map_canvas img,#map_canvas embed,#map_canvas object,.map_canvas img,.map_canvas embed,.map_canvas object{max-width:none!important}.left{float:left!important}.right{float:right!important}.text-left{text-align:left!important}.text-right{text-align:right!important}.text-center{text-align:center!important}.text-justify{text-align:justify!important}.hide{display:none}.antialiased,body{-webkit-font-smoothing:antialiased}img{display:inline-block;vertical-align:middle}textarea{height:auto;min-height:50px}select{width:100%}p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}a{color:#2156a5;text-decoration:underline;line-height:inherit}a:hover,a:focus{color:#1d4b8f}a img{border:none}p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}p aside{font-size:.875em;line-height:1.35;font-style:italic}h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}h1{font-size:2.125em}h2{font-size:1.6875em}h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}h4,h5{font-size:1.125em}h6{font-size:1em}hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}em,i{font-style:italic;line-height:inherit}strong,b{font-weight:bold;line-height:inherit}small{font-size:60%;line-height:inherit}code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}ul.square{list-style-type:square}ul.circle{list-style-type:circle}ul.disc{list-style-type:disc}ul.no-bullet{list-style:none}ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}dl dt{margin-bottom:.3125em;font-weight:bold}dl dd{margin-bottom:1.25em}abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}abbr{text-transform:none}blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}blockquote cite:before{content:"\2014 \0020"}blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}h1{font-size:2.75em}h2{font-size:2.3125em}h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}h4{font-size:1.4375em}}table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}table thead,table tfoot{background:#f7f8f7;font-weight:bold}table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}.clearfix:after,.float-group:after{clear:both}*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}.keyseq{color:rgba(51,51,51,.8)}kbd{display:inline-block;color:rgba(0,0,0,.8);font-size:.75em;line-height:1.4;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:-.15em .15em 0 .15em;padding:.2em .6em .2em .5em;vertical-align:middle;white-space:nowrap}.keyseq kbd:first-child{margin-left:0}.keyseq kbd:last-child{margin-right:0}.menuseq,.menu{color:rgba(0,0,0,.8)}b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}b.button:before{content:"[";padding:0 3px 0 2px}b.button:after{content:"]";padding:0 2px 0 3px}p a>code:hover{color:rgba(0,0,0,.9)}#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}#header:after,#content:after,#footnotes:after,#footer:after{clear:both}#content{margin-top:1.25em}#content:before{content:none}#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}#header .details span:first-child{margin-left:-.125em}#header .details span.email a{color:rgba(0,0,0,.85)}#header .details br{display:none}#header .details br+span:before{content:"\00a0\2013\00a0"}#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}#header .details br+span#revremark:before{content:"\00a0|\00a0"}#header #revnumber{text-transform:capitalize}#header #revnumber:after{content:"\00a0"}#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}#toc>ul{margin-left:.125em}#toc ul.sectlevel0>li>a{font-style:italic}#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}#toc a{text-decoration:none}#toc a:active{text-decoration:underline}#toctitle{color:#7a2518;font-size:1.2em}@media only screen and (min-width:768px){#toctitle{font-size:1.375em}body.toc2{padding-left:15em;padding-right:0}#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}#toc.toc2 #toctitle{margin-top:0;font-size:1.2em}#toc.toc2>ul{font-size:.9em;margin-bottom:0}#toc.toc2 ul ul{margin-left:0;padding-left:1em}#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}body.toc2.toc-right{padding-left:0;padding-right:15em}body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}#toc.toc2{width:20em}#toc.toc2 #toctitle{font-size:1.375em}#toc.toc2>ul{font-size:.95em}#toc.toc2 ul ul{padding-left:1.25em}body.toc2.toc-right{padding-left:0;padding-right:20em}}#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}#content #toc>:first-child{margin-top:0}#content #toc>:last-child{margin-bottom:0}#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}#footer-text{color:rgba(255,255,255,.8);line-height:1.44}.sect1{padding-bottom:.625em}@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}.sect1+.sect1{border-top:1px solid #efefed}#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}.admonitionblock>table td.icon{text-align:center;width:80px}.admonitionblock>table td.icon img{max-width:none}.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}.exampleblock>.content>:first-child{margin-top:0}.exampleblock>.content>:last-child{margin-bottom:0}.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}.sidebarblock>:first-child{margin-top:0}.sidebarblock>:last-child{margin-bottom:0}.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}.listingblock pre.highlightjs{padding:0}.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}.listingblock pre.prettyprint{border-width:0}.listingblock>.content{position:relative}.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}.listingblock:hover code[data-lang]:before{display:block}.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0}table.pyhltable td.code{padding-left:.75em;padding-right:0}pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}pre.pygments .lineno{display:inline-block;margin-right:.25em}table.pyhltable .linenodiv{background:none!important;padding-right:0!important}.quoteblock{margin:0 1em 1.25em 1.5em;display:table}.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}.quoteblock blockquote{margin:0;padding:0;border:0}.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}.quoteblock .quoteblock blockquote:before{display:none}.verseblock{margin:0 1em 1.25em 1em}.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}.verseblock pre strong{font-weight:400}.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}.quoteblock .attribution br,.verseblock .attribution br{display:none}.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.05em;color:rgba(0,0,0,.6)}.quoteblock.abstract{margin:0 0 1.25em 0;display:block}.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}table.tableblock{max-width:100%;border-collapse:separate}table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}table.spread{width:100%}table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}table.frame-all{border-width:1px}table.frame-sides{border-width:0 1px}table.frame-topbot{border-width:1px 0}th.halign-left,td.halign-left{text-align:left}th.halign-right,td.halign-right{text-align:right}th.halign-center,td.halign-center{text-align:center}th.valign-top,td.valign-top{vertical-align:top}th.valign-bottom,td.valign-bottom{vertical-align:bottom}th.valign-middle,td.valign-middle{vertical-align:middle}table thead th,table tfoot th{font-weight:bold}tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}p.tableblock>code:only-child{background:none;padding:0}p.tableblock{font-size:1em}td>div.verse{white-space:pre}ol{margin-left:1.75em}ul li ol{margin-left:1.5em}dl dd{margin-left:1.125em}dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}ul.inline>li>*{display:block}.unstyled dl dt{font-weight:400;font-style:normal}ol.arabic{list-style-type:decimal}ol.decimal{list-style-type:decimal-leading-zero}ol.loweralpha{list-style-type:lower-alpha}ol.upperalpha{list-style-type:upper-alpha}ol.lowerroman{list-style-type:lower-roman}ol.upperroman{list-style-type:upper-roman}ol.lowergreek{list-style-type:lower-greek}.hdlist>table,.colist>table{border:0;background:none}.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}td.hdlist1{padding-right:.75em;font-weight:bold}td.hdlist1,td.hdlist2{vertical-align:top}.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}.colist>table tr>td:last-of-type{padding:.25em 0}.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}.imageblock>.title{margin-bottom:0}.imageblock.thumb,.imageblock.th{border-width:6px}.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}.image.left{margin-right:.625em}.image.right{margin-left:.625em}a.image{text-decoration:none}span.footnote,span.footnoteref{vertical-align:super;font-size:.875em}span.footnote a,span.footnoteref a{text-decoration:none}span.footnote a:active,span.footnoteref a:active{text-decoration:underline}#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}#footnotes .footnote{padding:0 .375em;line-height:1.3;font-size:.875em;margin-left:1.2em;text-indent:-1.2em;margin-bottom:.2em}#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}#footnotes .footnote:last-of-type{margin-bottom:0}#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}.gist .file-data>table td.line-data{width:99%}div.unbreakable{page-break-inside:avoid}.big{font-size:larger}.small{font-size:smaller}.underline{text-decoration:underline}.overline{text-decoration:overline}.line-through{text-decoration:line-through}.aqua{color:#00bfbf}.aqua-background{background-color:#00fafa}.black{color:#000}.black-background{background-color:#000}.blue{color:#0000bf}.blue-background{background-color:#0000fa}.fuchsia{color:#bf00bf}.fuchsia-background{background-color:#fa00fa}.gray{color:#606060}.gray-background{background-color:#7d7d7d}.green{color:#006000}.green-background{background-color:#007d00}.lime{color:#00bf00}.lime-background{background-color:#00fa00}.maroon{color:#600000}.maroon-background{background-color:#7d0000}.navy{color:#000060}.navy-background{background-color:#00007d}.olive{color:#606000}.olive-background{background-color:#7d7d00}.purple{color:#600060}.purple-background{background-color:#7d007d}.red{color:#bf0000}.red-background{background-color:#fa0000}.silver{color:#909090}.silver-background{background-color:#bcbcbc}.teal{color:#006060}.teal-background{background-color:#007d7d}.white{color:#bfbfbf}.white-background{background-color:#fafafa}.yellow{color:#bfbf00}.yellow-background{background-color:#fafa00}span.icon>.fa{cursor:default}.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}.conum[data-value] *{color:#fff!important}.conum[data-value]+b{display:none}.conum[data-value]:after{content:attr(data-value)}pre .conum[data-value]{position:relative;top:-.125em}b.conum *{color:inherit!important}.conum:not([data-value]):empty{display:none}h1,h2{letter-spacing:-.01em}dt,th.tableblock,td.content{text-rendering:optimizeLegibility}p,td.content{letter-spacing:-.01em}p strong,td.content strong{letter-spacing:-.005em}p,blockquote,dt,td.content{font-size:1.0625rem}p{margin-bottom:1.25rem}.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}.print-only{display:none!important}@media print{@page{margin:1.25cm .75cm}*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}a{color:inherit!important;text-decoration:underline!important}a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}abbr[title]:after{content:" (" attr(title) ")"}pre,blockquote,tr,img{page-break-inside:avoid}thead{display:table-header-group}img{max-width:100%!important}p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}#toc,.sidebarblock,.exampleblock>.content{background:none!important}#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}.sect1{padding-bottom:0!important}.sect1+.sect1{border:0!important}#header>h1:first-child{margin-top:1.25rem}body.book #header{text-align:center}body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}body.book #header .details{border:0!important;display:block;padding:0!important}body.book #header .details span:first-child{margin-left:0!important}body.book #header .details br{display:block}body.book #header .details br+span:before{content:none!important}body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}.listingblock code[data-lang]:before{display:block}#footer{background:none!important;padding:0 .9375em}#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}.hide-on-print{display:none!important}.print-only{display:block!important}.hide-for-print{display:none!important}.show-for-print{display:inherit!important}}</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.2.0/css/font-awesome.min.css">
<style>.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}.CodeRay .line-numbers strong{font-weight:normal}table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}table.CodeRay td{vertical-align:top}table.CodeRay td.line-numbers{text-align:right}table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}table.CodeRay td.code{padding:0 0 0 .5em}table.CodeRay td.code>pre{padding:0}.CodeRay .debug{color:#fff!important;background:#000080!important}.CodeRay .annotation{color:#007}.CodeRay .attribute-name{color:#000080}.CodeRay .attribute-value{color:#700}.CodeRay .binary{color:#509}.CodeRay .comment{color:#998;font-style:italic}.CodeRay .char{color:#04d}.CodeRay .char .content{color:#04d}.CodeRay .char .delimiter{color:#039}.CodeRay .class{color:#458;font-weight:bold}.CodeRay .complex{color:#a08}.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}.CodeRay .color{color:#099}.CodeRay .class-variable{color:#369}.CodeRay .decorator{color:#b0b}.CodeRay .definition{color:#099}.CodeRay .delimiter{color:#000}.CodeRay .doc{color:#970}.CodeRay .doctype{color:#34b}.CodeRay .doc-string{color:#d42}.CodeRay .escape{color:#666}.CodeRay .entity{color:#800}.CodeRay .error{color:#808}.CodeRay .exception{color:inherit}.CodeRay .filename{color:#099}.CodeRay .function{color:#900;font-weight:bold}.CodeRay .global-variable{color:#008080}.CodeRay .hex{color:#058}.CodeRay .integer,.CodeRay .float{color:#099}.CodeRay .include{color:#555}.CodeRay .inline{color:#00}.CodeRay .inline .inline{background:#ccc}.CodeRay .inline .inline .inline{background:#bbb}.CodeRay .inline .inline-delimiter{color:#d14}.CodeRay .inline-delimiter{color:#d14}.CodeRay .important{color:#555;font-weight:bold}.CodeRay .interpreted{color:#b2b}.CodeRay .instance-variable{color:#008080}.CodeRay .label{color:#970}.CodeRay .local-variable{color:#963}.CodeRay .octal{color:#40e}.CodeRay .predefined{color:#369}.CodeRay .preprocessor{color:#579}.CodeRay .pseudo-class{color:#555}.CodeRay .directive{font-weight:bold}.CodeRay .type{font-weight:bold}.CodeRay .predefined-type{color:inherit}.CodeRay .reserved,.CodeRay .keyword{color:#000;font-weight:bold}.CodeRay .key{color:#808}.CodeRay .key .delimiter{color:#606}.CodeRay .key .char{color:#80f}.CodeRay .value{color:#088}.CodeRay .regexp .delimiter{color:#808}.CodeRay .regexp .content{color:#808}.CodeRay .regexp .modifier{color:#808}.CodeRay .regexp .char{color:#d14}.CodeRay .regexp .function{color:#404;font-weight:bold}.CodeRay .string{color:#d20}.CodeRay .string .string .string{background:#ffd0d0}.CodeRay .string .content{color:#d14}.CodeRay .string .char{color:#d14}.CodeRay .string .delimiter{color:#d14}.CodeRay .shell{color:#d14}.CodeRay .shell .delimiter{color:#d14}.CodeRay .symbol{color:#990073}.CodeRay .symbol .content{color:#a60}.CodeRay .symbol .delimiter{color:#630}.CodeRay .tag{color:#008080}.CodeRay .tag-special{color:#d70}.CodeRay .variable{color:#036}.CodeRay .insert{background:#afa}.CodeRay .delete{background:#faa}.CodeRay .change{color:#aaf;background:#007}.CodeRay .head{color:#f8f;background:#505}.CodeRay .insert .insert{color:#080}.CodeRay .delete .delete{color:#800}.CodeRay .change .change{color:#66f}.CodeRay .head .head{color:#f4f}</style>
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Spring Session</h1>
<div class="details">
<span id="author" class="author">Rob Winch</span><br>
<span id="revnumber">version 1.0.2.RELEASE</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#introduction">Introduction</a></li>
<li><a href="#samples">Samples and Guides (Start Here)</a></li>
<li><a href="#httpsession">HttpSession Integration</a>
<ul class="sectlevel2">
<li><a href="#httpsession-why">Why Spring Session &amp; HttpSession?</a></li>
<li><a href="#httpsession-redis">HttpSession with Redis</a></li>
<li><a href="#httpsession-how">How HttpSession Integration Works</a></li>
<li><a href="#httpsession-multi">Multiple HttpSessions in Single Browser</a></li>
<li><a href="#httpsession-rest">HttpSession &amp; RESTful APIs</a></li>
<li><a href="#rest-spring-configuration">Spring Configuration</a></li>
<li><a href="#servlet-container-initialization">Servlet Container Initialization</a></li>
</ul>
</li>
<li><a href="#websocket">WebSocket Integration</a>
<ul class="sectlevel2">
<li><a href="#websocket-why">Why Spring Session &amp; WebSockets?</a></li>
<li><a href="#websocket-usage">WebSocket Usage</a></li>
</ul>
</li>
<li><a href="#api">API Documentation</a>
<ul class="sectlevel2">
<li><a href="#api-session">Session</a></li>
<li><a href="#api-expiringsession">ExpiringSession</a></li>
<li><a href="#api-sessionrepository">SessionRepository</a></li>
<li><a href="#api-redisoperationssessionrepository">RedisOperationsSessionRepository</a></li>
<li><a href="#api-mapsessionrepository">MapSessionRepository</a></li>
</ul>
</li>
<li><a href="#community">Spring Session Community</a>
<ul class="sectlevel2">
<li><a href="#community-support">Support</a></li>
<li><a href="#community-source">Source Code</a></li>
<li><a href="#community-issues">Issue Tracking</a></li>
<li><a href="#community-contributing">Contributing</a></li>
<li><a href="#community-license">License</a></li>
</ul>
</li>
<li><a href="#minimum-requirements">Minimum Requirements</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div id="abstract" class="paragraph">
<p>Spring Session provides an API and implementations for managing a user&#8217;s session information.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="introduction"><a class="anchor" href="#introduction"></a>Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Session provides an API and implementations for managing a user&#8217;s session information. It also provides transparent integration with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#httpsession">HttpSession</a> - allows replacing the HttpSession in an application container (i.e. Tomcat) neutral way.
Additional features include:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Clustered Sessions</strong> - Spring Session makes it trivial to support <a href="#httpsession-redis">clustered sessions</a> without being tied to an application container specific solution.</p>
</li>
<li>
<p><strong>Multiple Browser Sessions</strong> - Spring Session supports <a href="#httpsession-multi">managing multiple users' sessions</a> in a single browser instance (i.e. multiple authenticated accounts similar to Google).</p>
</li>
<li>
<p><strong>RESTful APIs</strong> - Spring Session allows providing session ids in headers to work with <a href="#httpsession-rest">RESTful APIs</a></p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="#websocket">WebSocket</a> - provides the ability to keep the <code>HttpSession</code> alive when receiving WebSocket messages</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="samples"><a class="anchor" href="#samples"></a>Samples and Guides (Start Here)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you are looking to get started with Spring Session, the best place to start is our Sample Applications.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. Sample Applications</caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 33%;">
<col style="width: 33%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Source</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Guide</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/1.0.2.RELEASE//samples/httpsession">HttpSession</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session to replace the <code>HttpSession</code> with a Redis store.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guides/httpsession.html">HttpSession Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/1.0.2.RELEASE//samples/httpsession-xml">HttpSession XML</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session to replace the <code>HttpSession</code> with a Redis store using XML based configuration.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guides/httpsession-xml.html">HttpSession XML Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/1.0.2.RELEASE//samples/boot">Spring Boot</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session with Spring Boot.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guides/boot.html">Spring Boot Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/1.0.2.RELEASE//samples/security">Spring Security</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session with an existing Spring Security application.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guides/security.html">Spring Security Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/1.0.2.RELEASE//samples/rest">REST</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session in a REST application to support authenticating with a header.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guides/rest.html">REST Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/1.0.2.RELEASE//samples/users">Multiple Users</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session to manage multiple simultaneous browser sessions (i.e Google Accounts).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guides/users.html">Manage Multiple Users Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/1.0.2.RELEASE//samples/websocket">WebSocket</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session with WebSockets.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guides/websocket.html">WebSocket Guide</a>
</p><p class="tableblock"><a id="samples-hazelcast"></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/1.0.2.RELEASE//samples/hazelcast">Hazelcast</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session with Hazelcast.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TBD</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="httpsession"><a class="anchor" href="#httpsession"></a>HttpSession Integration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Session provides transparent integration with <code>HttpSession</code>.
This means that developers can switch the <code>HttpSession</code> implementation out with an implementation that is backed by Spring Session.</p>
</div>
<div class="sect2">
<h3 id="httpsession-why"><a class="anchor" href="#httpsession-why"></a>Why Spring Session &amp; HttpSession?</h3>
<div class="paragraph">
<p>We have already mentioned that Spring Session provides transparent integration with <code>HttpSession</code>, but what benefits do we get out of this?</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Clustered Sessions</strong> - Spring Session makes it trivial to support <a href="#httpsession-redis">clustered sessions</a> without being tied to an application container specific solution.</p>
</li>
<li>
<p><strong>Multiple Browser Sessions</strong> - Spring Session supports <a href="#httpsession-multi">managing multiple users' sessions</a> in a single browser instance (i.e. multiple authenticated accounts similar to Google).</p>
</li>
<li>
<p><strong>RESTful APIs</strong> - Spring Session allows providing session ids in headers to work with <a href="#httpsession-rest">RESTful APIs</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="httpsession-redis"><a class="anchor" href="#httpsession-redis"></a>HttpSession with Redis</h3>
<div class="paragraph">
<p>Using Spring Session with <code>HttpSession</code> is enabled by adding a Servlet Filter before anything that uses the <code>HttpSession</code>.
You can choose from enabling this using either:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#httpsession-redis-jc">Java Based Configuration</a></p>
</li>
<li>
<p><a href="#httpsession-redis-xml">XML Based Configuration</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="httpsession-redis-jc"><a class="anchor" href="#httpsession-redis-jc"></a>Redis Java Based Configuration</h4>
<div class="paragraph">
<p>This section describes how to use Redis to back <code>HttpSession</code> using Java based configuration.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <a href="#samples">HttpSession Sample</a> provides a working sample on how to integrate Spring Session and <code>HttpSession</code> using XML configuration.
You can read the basic steps for integration below, but you are encouraged to follow along with the detailed HttpSession Guide when integrating with your own application.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="httpsession-spring-configuration"><a class="anchor" href="#httpsession-spring-configuration"></a>Spring Java Configuration</h5>
<div class="paragraph">
<p>After adding the required dependencies, we can create our Spring configuration.
The Spring configuration is responsible for creating a Servlet Filter that replaces the <code>HttpSession</code> implementation with an implementation backed by Spring Session.
Add the following Spring Configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@EnableRedisHttpSession</span> <i class="conum" data-value="1"></i><b>(1)</b>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Config</span> {

        <span class="annotation">@Bean</span>
        <span class="directive">public</span> JedisConnectionFactory connectionFactory() {
                <span class="keyword">return</span> <span class="keyword">new</span> JedisConnectionFactory(); <i class="conum" data-value="2"></i><b>(2)</b>
        }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>@EnableRedisHttpSession</code> annotation creates a Spring Bean with the name of <code>springSessionRepositoryFilter</code> that implements Filter.
The filter is what is in charge of replacing the <code>HttpSession</code> implementation to be backed by Spring Session.
In this instance Spring Session is backed by Redis.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We create a <code>RedisConnectionFactory</code> that connects Spring Session to the Redis Server.
We configure the connection to connect to localhost on the default port (6379)
For more information on configuring Spring Data Redis, refer to the <a href="http://docs.spring.io/spring-data/data-redis/docs/current/reference/html/">reference documentation</a>.</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="java-servlet-container-initialization"><a class="anchor" href="#java-servlet-container-initialization"></a>Java Servlet Container Initialization</h5>
<div class="paragraph">
<p>Our <a href="#httpsession-spring-configuration">Spring Configuration</a> created a Spring Bean named <code>springSessionRepositoryFilter</code> that implements <code>Filter</code>.
The <code>springSessionRepositoryFilter</code> bean is responsible for replacing the <code>HttpSession</code> with a custom implementation that is backed by Spring Session.</p>
</div>
<div class="paragraph">
<p>In order for our <code>Filter</code> to do its magic, Spring needs to load our <code>Config</code> class.
Last we need to ensure that our Servlet Container (i.e. Tomcat) uses our <code>springSessionRepositoryFilter</code> for every request.
Fortunately, Spring Session provides a utility class named <code>AbstractHttpSessionApplicationInitializer</code> both of these steps extremely easy.
You can find an example below:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/sample/Initializer.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Initializer</span>
                <span class="directive">extends</span> AbstractHttpSessionApplicationInitializer { <i class="conum" data-value="1"></i><b>(1)</b>

        <span class="directive">public</span> Initializer() {
                <span class="local-variable">super</span>(Config.class); <i class="conum" data-value="2"></i><b>(2)</b>
        }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The name of our class (Initializer) does not matter. What is important is that we extend <code>AbstractHttpSessionApplicationInitializer</code>.
</td>
</tr>
</table>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The first step is to extend <code>AbstractHttpSessionApplicationInitializer</code>.
This ensures that the Spring Bean by the name <code>springSessionRepositoryFilter</code> is registered with our Servlet Container for every request.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>AbstractHttpSessionApplicationInitializer</code> also provides a mechanism to easily ensure Spring loads our <code>Config</code>.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="httpsession-redis-xml"><a class="anchor" href="#httpsession-redis-xml"></a>Redis XML Based Configuration</h4>
<div class="paragraph">
<p>This section describes how to use Redis to back <code>HttpSession</code> using XML based configuration.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <a href="#samples">HttpSession XML Sample</a> provides a working sample on how to integrate Spring Session and <code>HttpSession</code> using XML configuration.
You can read the basic steps for integration below, but you are encouraged to follow along with the detailed HttpSession XML Guide when integrating with your own application.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="httpsession-xml-spring-configuration"><a class="anchor" href="#httpsession-xml-spring-configuration"></a>Spring XML Configuration</h5>
<div class="paragraph">
<p>After adding the required dependencies, we can create our Spring configuration.
The Spring configuration is responsible for creating a Servlet Filter that replaces the <code>HttpSession</code> implementation with an implementation backed by Spring Session.
Add the following Spring Configuration:</p>
</div>
<div class="listingblock">
<div class="title">src/main/webapp/WEB-INF/spring/session.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><i class="conum" data-value="1"></i><b>(1)</b>
<span class="tag">&lt;context:annotation-config</span><span class="tag">/&gt;</span>
<span class="tag">&lt;bean</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.springframework.session.data.redis.config.annotation.web.http.RedisHttpSessionConfiguration</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>

<i class="conum" data-value="2"></i><b>(2)</b>
<span class="tag">&lt;bean</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.springframework.data.redis.connection.jedis.JedisConnectionFactory</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We use the combination of <code>&lt;context:annotation-config/&gt;</code> and <code>RedisHttpSessionConfiguration</code> because Spring Session does not yet provide XML Namespace support (see <a href="https://github.com/spring-projects/spring-session/issues/104">gh-104</a>).
This creates a Spring Bean with the name of <code>springSessionRepositoryFilter</code> that implements Filter.
The filter is what is in charge of replacing the <code>HttpSession</code> implementation to be backed by Spring Session.
In this instance Spring Session is backed by Redis.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We create a <code>RedisConnectionFactory</code> that connects Spring Session to the Redis Server.
We configure the connection to connect to localhost on the default port (6379)
For more information on configuring Spring Data Redis, refer to the <a href="http://docs.spring.io/spring-data/data-redis/docs/current/reference/html/">reference documentation</a>.</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="xml-servlet-container-initialization"><a class="anchor" href="#xml-servlet-container-initialization"></a>XML Servlet Container Initialization</h5>
<div class="paragraph">
<p>Our <a href="#httpsession-xml-spring-configuration">Spring Configuration</a> created a Spring Bean named <code>springSessionRepositoryFilter</code> that implements <code>Filter</code>.
The <code>springSessionRepositoryFilter</code> bean is responsible for replacing the <code>HttpSession</code> with a custom implementation that is backed by Spring Session.</p>
</div>
<div class="paragraph">
<p>In order for our <code>Filter</code> to do its magic, we need to instruct Spring to load our <code>session.xml</code> configuration.
We do this with the following configuration:</p>
</div>
<div class="listingblock">
<div class="title">src/main/webapp/WEB-INF/web.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;context-param&gt;</span>
    <span class="tag">&lt;param-name&gt;</span>contextConfigLocation<span class="tag">&lt;/param-name&gt;</span>
    <span class="tag">&lt;param-value&gt;</span>
        /WEB-INF/spring/*.xml
    <span class="tag">&lt;/param-value&gt;</span>
<span class="tag">&lt;/context-param&gt;</span>
<span class="tag">&lt;listener&gt;</span>
    <span class="tag">&lt;listener-class&gt;</span>
        org.springframework.web.context.ContextLoaderListener
    <span class="tag">&lt;/listener-class&gt;</span>
<span class="tag">&lt;/listener&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="http://docs.spring.io/spring/docs/current/spring-framework-reference/htmlsingle/#context-create">ContextLoaderListener</a> reads the contextConfigLocation and picks up our session.xml configuration.</p>
</div>
<div class="paragraph">
<p>Last we need to ensure that our Servlet Container (i.e. Tomcat) uses our <code>springSessionRepositoryFilter</code> for every request.
The following snippet performs this last step for us:</p>
</div>
<div class="listingblock">
<div class="title">src/main/webapp/WEB-INF/web.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;filter&gt;</span>
    <span class="tag">&lt;filter-name&gt;</span>springSessionRepositoryFilter<span class="tag">&lt;/filter-name&gt;</span>
    <span class="tag">&lt;filter-class&gt;</span>org.springframework.web.filter.DelegatingFilterProxy<span class="tag">&lt;/filter-class&gt;</span>
<span class="tag">&lt;/filter&gt;</span>
<span class="tag">&lt;filter-mapping&gt;</span>
    <span class="tag">&lt;filter-name&gt;</span>springSessionRepositoryFilter<span class="tag">&lt;/filter-name&gt;</span>
    <span class="tag">&lt;url-pattern&gt;</span>/*<span class="tag">&lt;/url-pattern&gt;</span>
<span class="tag">&lt;/filter-mapping&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="http://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/filter/DelegatingFilterProxy.html">DelegatingFilterProxy</a> will look up a Bean by the name of <code>springSessionRepositoryFilter</code> and cast it to a <code>Filter</code>.
For every request that <code>DelegatingFilterProxy</code> is invoked, the <code>springSessionRepositoryFilter</code> will be invoked.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="httpsession-how"><a class="anchor" href="#httpsession-how"></a>How HttpSession Integration Works</h3>
<div class="paragraph">
<p>Fortunately both <code>HttpSession</code> and <code>HttpServletRequest</code> (the API for obtaining an <code>HttpSession</code>) are both interfaces.
This means that we can provide our own implementations for each of these APIs.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This section describes how Spring Session provides transparent integration with <code>HttpSession</code>. The intent is so that user&#8217;s can understand what is happening under the covers. This functionality is already integrated and you do NOT need to implement this logic yourself.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>First we create a custom <code>HttpServletRequest</code> that returns a custom implementation of <code>HttpSession</code>.
It looks something like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">SessionRepositoryRequestWrapper</span> <span class="directive">extends</span> HttpServletRequestWrapper {

        <span class="directive">public</span> SessionRepositoryRequestWrapper(HttpServletRequest original) {
                <span class="local-variable">super</span>(original);
        }

        <span class="directive">public</span> HttpSession getSession() {
                <span class="keyword">return</span> getSession(<span class="predefined-constant">true</span>);
        }

        <span class="directive">public</span> HttpSession getSession(<span class="type">boolean</span> createNew) {
                <span class="comment">// create an HttpSession implementation from Spring Session</span>
        }

        <span class="comment">// ... other methods delegate to the original HttpServletRequest ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Any method that returns an <code>HttpSession</code> is overridden.
All other methods are implemented by <code>HttpServletRequestWrapper</code> and simply delegate to the original <code>HttpServletRequest</code> implementation.</p>
</div>
<div class="paragraph">
<p>We replace the <code>HttpServletRequest</code> implementation using a servlet <code>Filter</code> called <code>SessionRepositoryFilter</code>.
The pseudocode can be found below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">SessionRepositoryFilter</span> <span class="directive">implements</span> <span class="predefined-type">Filter</span> {

        <span class="directive">public</span> doFilter(ServletRequest request, ServletResponse response, FilterChain chain) {
                HttpServletRequest httpRequest = (HttpServletRequest) request;
                SessionRepositoryRequestWrapper customRequest =
                        <span class="keyword">new</span> SessionRepositoryRequestWrapper(httpRequest);

                chain.doFilter(customRequest, response, chain);
        }

        <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>By passing in a custom <code>HttpServletRequest</code> implementation into the <code>FilterChain</code> we ensure that anything invoked after our <code>Filter</code> uses the custom <code>HttpSession</code> implementation.
This highlights why it is important that Spring Session&#8217;s <code>SessionRepositoryFilter</code> must be placed before anything that interacts with the <code>HttpSession</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="httpsession-multi"><a class="anchor" href="#httpsession-multi"></a>Multiple HttpSessions in Single Browser</h3>
<div class="paragraph">
<p>Spring Session has the ability to support multiple sessions in a single browser instance.
This provides the ability to support authenticating with multiple users in the same browser instance (i.e. Google Accounts).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <a href="#samples">Manage Multiple Users Guide</a> provides a complete working example of managing multiple users in the same browser instance.
You can follow the basic steps for integration below, but you are encouraged to follow along with the detailed Manage Multiple Users Guide when integrating with your own application.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Let&#8217;s take a look at how Spring Session keeps track of multiple sessions.</p>
</div>
<div class="sect3">
<h4 id="managing-a-single-session"><a class="anchor" href="#managing-a-single-session"></a>Managing a Single Session</h4>
<div class="paragraph">
<p>Spring Session keeps track of the <code>HttpSession</code> by adding a value to a cookie named SESSION.
For example, the SESSION cookie might have a value of:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>7e8383a4-082c-4ffe-a4bc-c40fd3363c5e</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="adding-a-session"><a class="anchor" href="#adding-a-session"></a>Adding a Session</h4>
<div class="paragraph">
<p>We can add another session by requesting a URL that contains a special parameter in it.
By default the parameter name is <strong>_s</strong>. For example, the following URL would create a new session:</p>
</div>
<div class="paragraph">
<p><a href="http://localhost:8080/?_s=1" class="bare">http://localhost:8080/?_s=1</a></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The parameter value does not indicate the actual session id.
This is important because we never want to allow the session id to be determined by a client to avoid <a href="https://www.owasp.org/index.php/Session_fixation">session fixation attacks</a>.
Additionally, we do not want the session id to be leaked since it is sent as a query parameter.
Remember sensitive information should only be transmitted as a header or in the body of the request.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Rather than creating the URL ourselves, we can utilize the <code>HttpSessionManager</code> to do this for us.
We can obtain the <code>HttpSessionManager</code> from the <code>HttpServletRequest</code> using the following:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/sample/UserAccountsFilter.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">HttpSessionManager sessionManager =
        (HttpSessionManager) httpRequest.getAttribute(HttpSessionManager.class.getName());</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can now use it to create a URL to add another session.</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/sample/UserAccountsFilter.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">String</span> addAlias = unauthenticatedAlias == <span class="predefined-constant">null</span> ? <i class="conum" data-value="1"></i><b>(1)</b>
        sessionManager.getNewSessionAlias(httpRequest) : <i class="conum" data-value="2"></i><b>(2)</b>
        unauthenticatedAlias; <i class="conum" data-value="3"></i><b>(3)</b>
<span class="predefined-type">String</span> addAccountUrl = sessionManager.encodeURL(contextPath, addAlias); <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We have an existing variable named <code>unauthenticatedAlias</code>.
The value is an alias that points to an existing unauthenticated session.
If no such session exists, the value is null.
This ensures if we have an existing unauthenticated session that we use it instead of creating a new session.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>If all of our sessions are already associated to a user, we create a new session alias.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>If there is an existing session that is not associated to a user, we use its session alias.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Finally, we create the add account URL.
The URL contains a session alias that either points to an existing unauthenticated session or is an alias that is unused thus signaling to create a new session associated to that alias.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now our SESSION cookie looks something like this:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>0 7e8383a4-082c-4ffe-a4bc-c40fd3363c5e 1 1d526d4a-c462-45a4-93d9-84a39b6d44ad</pre>
</div>
</div>
<div class="paragraph">
<p>Such that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>There is a session with the id <strong>7e8383a4-082c-4ffe-a4bc-c40fd3363c5e</strong></p>
<div class="ulist">
<ul>
<li>
<p>The alias for this session is <strong>0</strong>.
For example, if the URL is <a href="http://localhost:8080/?_s=0" class="bare">http://localhost:8080/?_s=0</a> this alias would be used.</p>
</li>
<li>
<p>This is the default session.
This means that if no session alias is specified, then this session is used.
For example, if the URL is <a href="http://localhost:8080/" class="bare">http://localhost:8080/</a> this session would be used.</p>
</li>
</ul>
</div>
</li>
<li>
<p>There is a session with the id <strong>1d526d4a-c462-45a4-93d9-84a39b6d44ad</strong></p>
<div class="ulist">
<ul>
<li>
<p>The alias for this session is <strong>1</strong>.
If the session alias is <strong>1</strong>, then this session is used.
For example, if the URL is <a href="http://localhost:8080/?_s=1" class="bare">http://localhost:8080/?_s=1</a> this alias would be used.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="automatic-session-alias-inclusion-with-encodeurl"><a class="anchor" href="#automatic-session-alias-inclusion-with-encodeurl"></a>Automatic Session Alias Inclusion with encodeURL</h4>
<div class="paragraph">
<p>The nice thing about specifying the session alias in the URL is that we can have multiple tabs open with different active sessions.
The bad thing is that we need to include the session alias in every URL of our application.
Fortunately, Spring Session will automatically include the session alias in any URL that passes through <a href="http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletResponse.html#encodeURL(java.lang.String)">HttpServletResponse#encodeURL(java.lang.String)</a></p>
</div>
<div class="paragraph">
<p>This means that if you are using standard tag libraries the session alias is automatically included in the URL.
For example, if we are currently using the session with the alias of <strong>1</strong>, then the following:</p>
</div>
<div class="listingblock">
<div class="title">src/main/webapp/index.jsp</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">  --<span class="error">&gt;</span>
<span class="tag">&lt;c:url</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">/link.jsp</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">var</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">linkUrl</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;a</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">navLink</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${linkUrl}</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>Link<span class="tag">&lt;/a&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>will output a link of:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><span class="tag">&lt;a</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">navLink</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">/link.jsp?_s=1</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>Link<span class="tag">&lt;/a&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="httpsession-rest"><a class="anchor" href="#httpsession-rest"></a>HttpSession &amp; RESTful APIs</h3>
<div class="paragraph">
<p>Spring Session can work with RESTful APIs by allowing the session to be provided in a header.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <a href="#samples">REST Sample</a> provides a working sample on how to use Spring Session in a REST application to support authenticating with a header.
You can follow the basic steps for integration below, but you are encouraged to follow along with the detailed REST Guide when integrating with your own application.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="rest-spring-configuration"><a class="anchor" href="#rest-spring-configuration"></a>Spring Configuration</h3>
<div class="paragraph">
<p>After adding the required dependencies, we can create our Spring configuration.
The Spring configuration is responsible for creating a Servlet Filter that replaces the <code>HttpSession</code> implementation with an implementation backed by Spring Session.
Add the following Spring Configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Configuration</span>
<span class="annotation">@EnableRedisHttpSession</span> <i class="conum" data-value="1"></i><b>(1)</b>
<span class="directive">public</span> <span class="type">class</span> <span class="class">HttpSessionConfig</span> {

        <span class="annotation">@Bean</span>
        <span class="directive">public</span> JedisConnectionFactory connectionFactory() {
                <span class="keyword">return</span> <span class="keyword">new</span> JedisConnectionFactory();  <i class="conum" data-value="2"></i><b>(2)</b>
        }

        <span class="annotation">@Bean</span>
        <span class="directive">public</span> HttpSessionStrategy httpSessionStrategy() {
                <span class="keyword">return</span> <span class="keyword">new</span> HeaderHttpSessionStrategy(); <i class="conum" data-value="3"></i><b>(3)</b>
        }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>@EnableRedisHttpSession</code> annotation creates a Spring Bean with the name of <code>springSessionRepositoryFilter</code> that implements <code>Filter</code>.
The filter is what is in charge of replacing the <code>HttpSession</code> implementation to be backed by Spring Session.
In this instance Spring Session is backed by Redis.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We create a <code>RedisConnectionFactory</code> that connects Spring Session to the Redis Server.
We configure the connection to connect to localhost on the default port (6379)
For more information on configuring Spring Data Redis, refer to the <a href="http://docs.spring.io/spring-data/data-redis/docs/current/reference/html/">reference documentation</a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We customize Spring Session&#8217;s HttpSession integration to use HTTP headers to convey the current session information instead of cookies.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="servlet-container-initialization"><a class="anchor" href="#servlet-container-initialization"></a>Servlet Container Initialization</h3>
<div class="paragraph">
<p>Our <a href="#rest-spring-configuration">Spring Configuration</a> created a Spring Bean named <code>springSessionRepositoryFilter</code> that implements <code>Filter</code>.
The <code>springSessionRepositoryFilter</code> bean is responsible for replacing the <code>HttpSession</code> with a custom implementation that is backed by Spring Session.</p>
</div>
<div class="paragraph">
<p>In order for our <code>Filter</code> to do its magic, Spring needs to load our <code>Config</code> class. We provide the configuration in our Spring <code>MvcInitializer</code> as shown below:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/sample/mvc/MvcInitializer.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Override</span>
<span class="directive">protected</span> <span class="predefined-type">Class</span>&lt;?&gt;<span class="type">[]</span> getRootConfigClasses() {
    <span class="keyword">return</span> <span class="keyword">new</span> <span class="predefined-type">Class</span><span class="type">[]</span> {SecurityConfig.class, HttpSessionConfig.class};
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Last we need to ensure that our Servlet Container (i.e. Tomcat) uses our <code>springSessionRepositoryFilter</code> for every request.
Fortunately, Spring Session provides a utility class named <code>AbstractHttpSessionApplicationInitializer</code> that makes this extremely easy. Simply extend the class with the default constructor as shown below:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/sample/Initializer.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Initializer</span> <span class="directive">extends</span> AbstractHttpSessionApplicationInitializer {

}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The name of our class (Initializer) does not matter. What is important is that we extend <code>AbstractHttpSessionApplicationInitializer</code>.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="websocket"><a class="anchor" href="#websocket"></a>WebSocket Integration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Session provides transparent integration with Spring&#8217;s WebSocket support.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Spring Session&#8217;s WebSocket support only works with Spring&#8217;s WebSocket support.
Specifically it does not work with using <a href="https://www.jcp.org/en/jsr/detail?id=356">JSR-356</a> directly.
This is due to the fact that JSR-356 does not have a mechanism for intercepting incoming WebSocket messages.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="websocket-why"><a class="anchor" href="#websocket-why"></a>Why Spring Session &amp; WebSockets?</h3>
<div class="paragraph">
<p>So why do we need Spring Session when using WebSockets?</p>
</div>
<div class="paragraph">
<p>Consider an email application that does much of its work through HTTP requests.
However, there is also a chat application embedded within it that works over WebSocket APIs.
If a user is actively chatting with someone, we should not timeout the <code>HttpSession</code> since this would be pretty poor user experience.
However, this is exactly what <a href="https://java.net/jira/browse/WEBSOCKET_SPEC-175">JSR-356</a> does.</p>
</div>
<div class="paragraph">
<p>Another issue is that according to JSR-356 if the <code>HttpSession</code> times out any WebSocket that was created with that HttpSession and an authenticated user should be forcibly closed.
This means that if we are actively chatting in our application and are not using the HttpSession, then we will also disconnect from our conversation!</p>
</div>
</div>
<div class="sect2">
<h3 id="websocket-usage"><a class="anchor" href="#websocket-usage"></a>WebSocket Usage</h3>
<div class="paragraph">
<p>The <a href="#samples">WebSocket Sample</a> provides a working sample on how to integrate Spring Session with WebSockets.
You can follow the basic steps for integration below, but you are encouraged to follow along with the detailed WebSocket Guide when integrating with your own application:</p>
</div>
<div class="sect3">
<h4 id="websocket-httpsession"><a class="anchor" href="#websocket-httpsession"></a>HttpSession Integration</h4>
<div class="paragraph">
<p>Before using WebSocket integration, you should be sure that you have <a href="#httpsession">HttpSession Integration</a> working first.</p>
</div>
</div>
<div class="sect3">
<h4 id="websocket-spring-configuration"><a class="anchor" href="#websocket-spring-configuration"></a>Spring Configuration</h4>
<div class="paragraph">
<p>In a typical Spring WebSocket application users would extend <code>AbstractWebSocketMessageBrokerConfigurer</code>.
For example, the configuration might look something like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Configuration</span>
<span class="annotation">@EnableScheduling</span>
<span class="annotation">@EnableWebSocketMessageBroker</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">WebSocketConfig</span>
                <span class="directive">extends</span> AbstractWebSocketMessageBrokerConfigurer {

        <span class="directive">public</span> <span class="type">void</span> registerStompEndpoints(StompEndpointRegistry registry) {
                registry.addEndpoint(<span class="string"><span class="delimiter">&quot;</span><span class="content">/messages</span><span class="delimiter">&quot;</span></span>)
                                .withSockJS();
        }

        <span class="annotation">@Override</span>
        <span class="directive">public</span> <span class="type">void</span> configureMessageBroker(MessageBrokerRegistry registry) {
                registry.enableSimpleBroker(<span class="string"><span class="delimiter">&quot;</span><span class="content">/queue/</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">/topic/</span><span class="delimiter">&quot;</span></span>);
                registry.setApplicationDestinationPrefixes(<span class="string"><span class="delimiter">&quot;</span><span class="content">/app</span><span class="delimiter">&quot;</span></span>);
        }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can easily update our configuration to use Spring Session&#8217;s WebSocket support.
For example:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/samples/config/WebSocketConfig.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Configuration</span>
<span class="annotation">@EnableScheduling</span>
<span class="annotation">@EnableWebSocketMessageBroker</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">WebSocketConfig</span>
          <span class="directive">extends</span> AbstractSessionWebSocketMessageBrokerConfigurer&lt;ExpiringSession&gt; { <i class="conum" data-value="1"></i><b>(1)</b>

        <span class="directive">protected</span> <span class="type">void</span> configureStompEndpoints(StompEndpointRegistry registry) { <i class="conum" data-value="2"></i><b>(2)</b>
                registry.addEndpoint(<span class="string"><span class="delimiter">&quot;</span><span class="content">/messages</span><span class="delimiter">&quot;</span></span>)
                                .withSockJS();
        }

        <span class="directive">public</span> <span class="type">void</span> configureMessageBroker(MessageBrokerRegistry registry) {
                registry.enableSimpleBroker(<span class="string"><span class="delimiter">&quot;</span><span class="content">/queue/</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">/topic/</span><span class="delimiter">&quot;</span></span>);
                registry.setApplicationDestinationPrefixes(<span class="string"><span class="delimiter">&quot;</span><span class="content">/app</span><span class="delimiter">&quot;</span></span>);
        }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To hook in the Spring Session support we only need to change two things:</p>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Instead of extending <code>AbstractWebSocketMessageBrokerConfigurer</code> we extend <code>AbstractSessionWebSocketMessageBrokerConfigurer</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We rename the <code>registerStompEndpoints</code> method to <code>configureStompEndpoints</code></td>
</tr>
</table>
</div>
<div class="paragraph">
<p>What does <code>AbstractSessionWebSocketMessageBrokerConfigurer</code> do behind the scenes?</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>WebSocketConnectHandlerDecoratorFactory</code> is added as a <code>WebSocketHandlerDecoratorFactory</code> to <code>WebSocketTransportRegistration</code>.
This ensures a custom <code>SessionConnectEvent</code> is fired that contains the <code>WebSocketSession</code>.
The <code>WebSocketSession</code> is necessary to terminate any WebSocket connections that are still open when a Spring Session is terminated.</p>
</li>
<li>
<p><code>SessionRepositoryMessageInterceptor</code> is added as a <code>HandshakeInterceptor</code> to every <code>StompWebSocketEndpointRegistration</code>.
This ensures that the Session is added to the WebSocket properties to enable updating the last accessed time.</p>
</li>
<li>
<p><code>SessionRepositoryMessageInterceptor</code> is added as a <code>ChannelInterceptor</code> to our inbound <code>ChannelRegistration</code>.
This ensures that every time an inbound message is received, that the last accessed time of our Spring Session is updated.</p>
</li>
<li>
<p><code>WebSocketRegistryListener</code> is created as a Spring Bean.
This ensures that we have a mapping of all of the Session id to the corresponding WebSocket connections.
By maintaining this mapping, we can close all the WebSocket connections when a Spring Session (HttpSession) is terminated.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="api"><a class="anchor" href="#api"></a>API Documentation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can browse the complete <a href="../../api/">Javadoc</a> online. The key APIs are described below:</p>
</div>
<div class="sect2">
<h3 id="api-session"><a class="anchor" href="#api-session"></a>Session</h3>
<div class="paragraph">
<p>A <code>Session</code> is a simplified <code>Map</code> of name value pairs.</p>
</div>
<div class="paragraph">
<p>Typical usage might look like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">RepositoryDemo</span>&lt;S <span class="directive">extends</span> Session&gt; {
    <span class="directive">private</span> SessionRepository&lt;S&gt; repository; <i class="conum" data-value="1"></i><b>(1)</b>

    <span class="directive">public</span> <span class="type">void</span> demo() {
        S toSave = repository.createSession(); <i class="conum" data-value="2"></i><b>(2)</b>

        <i class="conum" data-value="3"></i><b>(3)</b>
        User rwinch = <span class="keyword">new</span> User(<span class="string"><span class="delimiter">&quot;</span><span class="content">rwinch</span><span class="delimiter">&quot;</span></span>);
        toSave.setAttribute(ATTR_USER, rwinch);

        repository.save(toSave); <i class="conum" data-value="4"></i><b>(4)</b>

        S session = repository.getSession(toSave.getId()); <i class="conum" data-value="5"></i><b>(5)</b>

        <i class="conum" data-value="6"></i><b>(6)</b>
        User user = session.getAttribute(ATTR_USER);
        assertThat(user).isEqualTo(rwinch);
    }

    <span class="comment">// ... setter methods ...</span>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We create a <code>SessionRepository</code> instance with a generic type, <code>S</code>, that extends <code>Session</code>. The generic type is defined in our class.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We create a new <code>Session</code> using our <code>SessionRepository</code> and assign it to a variable of type <code>S</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We interact with the <code>Session</code>. In our example, we demonstrate saving a <code>User</code> to the <code>Session</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>We now save the <code>Session</code>. This is why we needed the generic type <code>S</code>. The <code>SessionRepository</code> only allows saving <code>Session</code> instances that were created or retrieved using the same <code>SessionRepository</code>. This allows for the <code>SessionRepository</code> to make implementation specific optimizations (i.e. only writing attributes that have changed).</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>We retrieve the <code>Session</code> from the <code>SessionRepository</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>We obtain the persisted <code>User</code> from our <code>Session</code> without the need for explicitly casting our attribute.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="api-expiringsession"><a class="anchor" href="#api-expiringsession"></a>ExpiringSession</h3>
<div class="paragraph">
<p>An <code>ExpiringSession</code> extends a <code>Session</code> by providing attributes related to the <code>Session</code> instance&#8217;s expiration.
If there is no need to interact with the expiration information, prefer using the more simple <code>Session</code> API.</p>
</div>
<div class="paragraph">
<p>Typical usage might look like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">ExpiringRepositoryDemo</span>&lt;S <span class="directive">extends</span> ExpiringSession&gt; {
    <span class="directive">private</span> SessionRepository&lt;S&gt; repository; <i class="conum" data-value="1"></i><b>(1)</b>

    <span class="directive">public</span> <span class="type">void</span> demo() {
        S toSave = repository.createSession(); <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="comment">// ...</span>
        toSave.setMaxInactiveIntervalInSeconds(<span class="integer">30</span>); <i class="conum" data-value="3"></i><b>(3)</b>

        repository.save(toSave); <i class="conum" data-value="4"></i><b>(4)</b>

        S session = repository.getSession(toSave.getId()); <i class="conum" data-value="5"></i><b>(5)</b>
        <span class="comment">// ...</span>
    }

    <span class="comment">// ... setter methods ...</span>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We create a <code>SessionRepository</code> instance with a generic type, <code>S</code>, that extends <code>ExpiringSession</code>. The generic type is defined in our class.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We create a new <code>ExpiringSession</code> using our <code>SessionRepository</code> and assign it to a variable of type <code>S</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We interact with the <code>ExpiringSession</code>.
In our example, we demonstrate updating the amount of time the <code>ExpiringSession</code> can be inactive before it expires.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>We now save the <code>ExpiringSession</code>.
This is why we needed the generic type <code>S</code>.
The <code>SessionRepository</code> only allows saving <code>ExpiringSession</code> instances that were created or retrieved using the same <code>SessionRepository</code>.
This allows for the <code>SessionRepository</code> to make implementation specific optimizations (i.e. only writing attributes that have changed).
The last accessed time is automatically updated when the <code>ExpiringSession</code> is saved.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>We retrieve the <code>ExpiringSession</code> from the <code>SessionRepository</code>.
If the <code>ExpiringSession</code> were expired, the result would be null.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="api-sessionrepository"><a class="anchor" href="#api-sessionrepository"></a>SessionRepository</h3>
<div class="paragraph">
<p>A <code>SessionRepository</code> is in charge of creating, retrieving, and persisting <code>Session</code> instances.</p>
</div>
<div class="paragraph">
<p>If possible, developers should not interact directly with a <code>SessionRepository</code> or a <code>Session</code>.
Instead, developers should prefer interacting with <code>SessionRepository</code> and <code>Session</code> indirectly through the <a href="#httpsession">HttpSession</a> and <a href="#websocket">WebSocket</a> integration.</p>
</div>
</div>
<div class="sect2">
<h3 id="api-redisoperationssessionrepository"><a class="anchor" href="#api-redisoperationssessionrepository"></a>RedisOperationsSessionRepository</h3>
<div class="paragraph">
<p><code>RedisOperationsSessionRepository</code> is a <code>SessionRepository</code> that is implemented using Spring Data&#8217;s <code>RedisOperations</code>.
In a web environment, this is typically used in combination with <code>SessionRepositoryFilter</code>.
The implementation supports <code>SessionDestroyedEvent</code> through <code>SessionMessageListener</code>.</p>
</div>
<div class="sect3">
<h4 id="api-redisoperationssessionrepository-new"><a class="anchor" href="#api-redisoperationssessionrepository-new"></a>Instantiating a RedisOperationsSessionRepository</h4>
<div class="paragraph">
<p>A typical example of how to create a new instance can be seen below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">JedisConnectionFactory factory = <span class="keyword">new</span> JedisConnectionFactory();
SessionRepository&lt;? <span class="directive">extends</span> ExpiringSession&gt; repository =
        <span class="keyword">new</span> RedisOperationsSessionRepository(factory);</code></pre>
</div>
</div>
<div class="paragraph">
<p>For additional information on how to create a <code>RedisConnectionFactory</code>, refer to the Spring Data Redis Reference.</p>
</div>
</div>
<div class="sect3">
<h4 id="api-redisoperationssessionrepository-storage"><a class="anchor" href="#api-redisoperationssessionrepository-storage"></a>Storage Details</h4>
<div class="paragraph">
<p>Each session is stored in Redis as a Hash.
Each session is set and updated using the HMSET command.
An example of how each session is stored can be seen below.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>HMSET spring:session:sessions:&lt;session-id&gt; creationTime 1404360000000 \
    maxInactiveInterval 1800 lastAccessedTime 1404360000000 \
    sessionAttr:&lt;attrName&gt; someAttrValue sessionAttr:&lt;attrName2&gt; someAttrValue2</pre>
</div>
</div>
<div class="sect4">
<h5 id="api-redisoperationssessionrepository-expiration"><a class="anchor" href="#api-redisoperationssessionrepository-expiration"></a>Session Expiration</h5>
<div class="paragraph">
<p>An expiration is associated to each session using the EXPIRE command based upon the RedisOperationsSessionRepository.RedisSession.getMaxInactiveInterval().
For example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>EXPIRE spring:session:sessions:&lt;session-id&gt; 1800</pre>
</div>
</div>
<div class="paragraph">
<p>Spring Session relies on the expired and delete <a href="http://redis.io/topics/notifications">keyspace notifications</a> from Redis to fire a <a href="#api-redisoperationssessionrepository-sessiondestroyedevent">SessionDestroyedEvent</a>.
It is the <code>SessionDestroyedEvent</code> that ensures resources associated with the Session are cleaned up.
For example, when using Spring Session&#8217;s WebSocket support the Redis expired or delete event is what triggers any WebSocket connections associated with the session to be closed.</p>
</div>
<div class="paragraph">
<p>One problem with this approach is that Redis makes no guarantee of when the expired event will be fired if they key has not been accessed.
Specifically the background task that Redis uses to clean up expired keys is a low priority task and may not trigger the key expiration.
For additional details see <a href="http://redis.io/topics/notifications">Timing of expired events</a> section in the Redis documentation.</p>
</div>
<div class="paragraph">
<p>To circumvent the fact that expired events are not guaranteed to happen we can ensure that each key is accessed when it is expected to expire.
This means that if the TTL is expired on the key, Redis will remove the key and fire the expired event when we try to access they key.</p>
</div>
<div class="paragraph">
<p>For this reason, each session expiration is also tracked to the nearest minute.
This allows a background task to access the potentially expired sessions to ensure that Redis expired events are fired in a more deterministic fashion.
For example:</p>
</div>
<div class="paragraph">
<p>SADD spring:session:expirations:&lt;expire-rounded-up-to-nearest-minute&gt; &lt;session-id&gt;
EXPIRE spring:session:expirations:&lt;expire-rounded-up-to-nearest-minute&gt; 1860</p>
</div>
<div class="paragraph">
<p>The background task will then use these mappings to explicitly request each key.
By accessing they key, rather than deleting it, we ensure that Redis deletes the key for us only if the TTL is expired.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
We do not explicitly delete the keys since in some instances there may be a race condition that incorrectly identifies a key as expired when it is not.
Short of using distributed locks (which would kill our performance) there is no way to ensure the consistency of the expiration mapping.
By simply accessing the key, we ensure that the key is only removed if the TTL on that key is expired.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="api-redisoperationssessionrepository-writes"><a class="anchor" href="#api-redisoperationssessionrepository-writes"></a>Optimized Writes</h5>
<div class="paragraph">
<p>The <code>Session</code> instances managed by <code>RedisOperationsSessionRepository</code> keeps track of the properties that have changed and only updates those.
This means if an attribute is written once and read many times we only need to write that attribute once.
For example, assume the session attribute "sessionAttr2" from earlier was updated.
The following would be executed upon saving:</p>
</div>
<div class="paragraph">
<p>HMSET spring:session:sessions:&lt;session-id&gt; sessionAttr:&lt;attrName2&gt; newValue
EXPIRE spring:session:sessions:&lt;session-id&gt; 1800</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-redisoperationssessionrepository-sessiondestroyedevent"><a class="anchor" href="#api-redisoperationssessionrepository-sessiondestroyedevent"></a>SessionDestroyedEvent</h4>
<div class="paragraph">
<p><code>RedisOperationsSessionRepository</code> supports firing a <code>SessionDestroyedEvent</code> whenever a <code>Session</code> is deleted or when it expires.
This is necessary to ensure resources associated with the <code>Session</code> are properly cleaned up.
For example, when integrating with WebSockets the <code>SessionDestroyedEvent</code> is in charge of closing any active WebSocket connections.</p>
</div>
<div class="paragraph">
<p>Firing a <code>SessionDestroyedEvent</code> is made available through the <code>SessionMessageListener</code> which listens to <a href="http://redis.io/topics/notifications">Redis Keyspace events</a>.
In order for this to work, Redis Keyspace events for Generic commands and Expired events needs to be enabled.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">redis-cli config set notify-keyspace-events Egx</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you are using <code>@EnableRedisHttpSession</code> the <code>SessionMessageListener</code> and enabling the necessary Redis Keyspace events is done automatically.
However, in a secured Redis enviornment the config command is disabled.
This means that Spring Session cannot configure Redis Keyspace events for you.
To disable the automatic configuration add <code>ConfigureRedisAction.NO_OP</code> as a bean.</p>
</div>
<div class="paragraph">
<p>For example, Java Configuration can use the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Bean</span>
<span class="directive">public</span> <span class="directive">static</span> ConfigureRedisAction configureRedisAction() {
    <span class="keyword">return</span> ConfigureRedisAction.NO_OP;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>XML Configuraiton can use the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;util:constant</span>
    <span class="attribute-name">static-field</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.springframework.session.data.redis.config.ConfigureRedisAction.NO_OP</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-redisoperationssessionrepository-cli"><a class="anchor" href="#api-redisoperationssessionrepository-cli"></a>Viewing the Session in Redis</h4>
<div class="paragraph">
<p>After <a href="http://redis.io/topics/quickstart">installing redis-cli</a>, you can inspect the values in Redis <a href="http://redis.io/commands#hash">using the redis-cli</a>.
For example, enter the following into a terminal:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ redis-cli
redis 127.0.0.1:6379&gt; keys *
1) &quot;spring:session:sessions:4fc39ce3-63b3-4e17-b1c4-5e1ed96fb021&quot; <i class="conum" data-value="1"></i><b>(1)</b>
2) &quot;spring:session:expirations:1418772300000&quot; <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The suffix of this key is the session identifier of the Spring Session.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This key contains all the session ids that should be deleted at the time <code>1418772300000</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can also view the attributes of each session.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">redis 127.0.0.1:6379&gt; hkeys spring:session:sessions:4fc39ce3-63b3-4e17-b1c4-5e1ed96fb021
1) &quot;lastAccessedTime&quot;
2) &quot;creationTime&quot;
3) &quot;maxInactiveInterval&quot;
4) &quot;sessionAttr:username&quot;
redis 127.0.0.1:6379&gt; hget spring:session:sessions:4fc39ce3-63b3-4e17-b1c4-5e1ed96fb021 sessionAttr:username
&quot;\xac\xed\x00\x05t\x00\x03rob&quot;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="api-mapsessionrepository"><a class="anchor" href="#api-mapsessionrepository"></a>MapSessionRepository</h3>
<div class="paragraph">
<p>The <code>MapSessionRepository</code> allows for persisting <code>ExpiringSession</code> in a <code>Map</code> with the key being the <code>ExpiringSession</code> id and the value being the <code>ExpiringSession</code>.
The implementation can be used with a <code>ConcurrentHashMap</code> as a testing or convenience mechanism.
Alternatively, it can be used with distributed <code>Map</code> implementations. For example, it can be used with Hazelcast.</p>
</div>
<div class="sect3">
<h4 id="api-mapsessionrepository-new"><a class="anchor" href="#api-mapsessionrepository-new"></a>Instantiating MapSessionRepository</h4>
<div class="paragraph">
<p>Creating a new instance is as simple as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">SessionRepository&lt;? <span class="directive">extends</span> ExpiringSession&gt; repository = <span class="keyword">new</span> MapSessionRepository();</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-mapsessionrepository-hazelcast"><a class="anchor" href="#api-mapsessionrepository-hazelcast"></a>Using Spring Session and Hazlecast</h4>
<div class="paragraph">
<p>The <a href="#samples">Hazelcast Sample</a> is a complete application demonstrating using Spring Session with Hazelcast.
To run it use the following:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./gradlew :samples:hazelcast:tomcatRun</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="community"><a class="anchor" href="#community"></a>Spring Session Community</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We are glad to consider you a part of our community.
Please find additional information below.</p>
</div>
<div class="sect2">
<h3 id="community-support"><a class="anchor" href="#community-support"></a>Support</h3>
<div class="paragraph">
<p>You can get help by asking questions on <a href="http://stackoverflow.com/questions/tagged/spring-session">StackOverflow with the tag spring-session</a>.
Similarly we encourage helping others by answering questions on StackOverflow.</p>
</div>
</div>
<div class="sect2">
<h3 id="community-source"><a class="anchor" href="#community-source"></a>Source Code</h3>
<div class="paragraph">
<p>Our source code can be found on github at <a href="https://github.com/spring-projects/spring-session/" class="bare">https://github.com/spring-projects/spring-session/</a></p>
</div>
</div>
<div class="sect2">
<h3 id="community-issues"><a class="anchor" href="#community-issues"></a>Issue Tracking</h3>
<div class="paragraph">
<p>We track issues in github issues at <a href="https://github.com/spring-projects/spring-session/issues" class="bare">https://github.com/spring-projects/spring-session/issues</a></p>
</div>
</div>
<div class="sect2">
<h3 id="community-contributing"><a class="anchor" href="#community-contributing"></a>Contributing</h3>
<div class="paragraph">
<p>We appreciate <a href="https://help.github.com/articles/using-pull-requests/">Pull Requests</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="community-license"><a class="anchor" href="#community-license"></a>License</h3>
<div class="paragraph">
<p>Spring Session is Open Source software released under the <a href="http://www.apache.org/licenses/LICENSE-2.0.html">Apache 2.0 license</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="minimum-requirements"><a class="anchor" href="#minimum-requirements"></a>Minimum Requirements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The minimum requirements for Spring Session are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Java 5+</p>
</li>
<li>
<p>If you are running in a Servlet Container (not required), Servlet 2.5+</p>
</li>
<li>
<p>If you are using other Spring libraries (not required), the minimum required version is Spring 3.2.14.
While we re-run all unit tests against Spring 3.2.x, we recommend using the latest Spring 4.x version when possible.</p>
</li>
<li>
<p><code>@EnableRedisHttpSession</code> requires Redis 2.8+. This is necessary to support <a href="#api-redisoperationssessionrepository-expiration">Session Expiration</a></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>At its core Spring Session only has a required dependency on commons-logging.
For an example of using Spring Session without any other Spring dependencies, refer to the <a href="#samples">hazelcast sample</a> application.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 1.0.2.RELEASE<br>
Last updated 2015-08-03 14:03:18 PDT
</div>
</div>
 
<script type="text/javascript">
        var _gaq = _gaq || [];
        var pluginUrl = '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
        _gaq.push(
            ['_require', 'inpage_linkid', pluginUrl],
            ['_setAccount', 'UA-2728886-23'],
            ['_trackPageview'],
            ['b._require', 'inpage_linkid', pluginUrl],
            ['b._setAccount', 'UA-2728886-19'],
            ['b._trackPageview']
        );
        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    </script>
 
<script type="text/javascript">

function detectLastFrame() {
   var thisF = this.window;
   var allF = parent.top.frames;
   return allF[allF.length - 1] == thisF; }

// Only inject the following code if this is a normal page or the last // frame of a frameset.
if (parent.top.frames.length == 0 || detectLastFrame()) {
    // Inject the SpringSource search widget too.
    document.write(unescape("%3Cscript src='http://search.springsource.org/widget/searchtool.js' type='text/javascript'%3E%3C/script%3E"));
    // Inject the Eloqua code
    //document.write(unescape("%3Cscript src='/elqNow/elqCfg.js' type='text/javascript'%3E%3C/script%3E"));
    //document.write(unescape("%3Cscript src='/elqNow/elqImg.js' type='text/javascript'%3E%3C/script%3E"));

}
</script>
</body>
</html>